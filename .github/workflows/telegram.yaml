name: telegram message

on:
  pull_request:
    branches: [ "master" ]
    types:
      - opened
      - reopened
      - closed
      - synchronize

jobs:
  build:
    if: ${{ !github.event.pull_request.merged }}
    uses: ./.github/workflows/gradle.yml
  messageOnUpdate:
    runs-on: ubuntu-latest
    if: ${{ always() && github.event.action == 'synchronize'}}
    needs: build
    steps:
      - name: send message
        if: ${{ !contains(needs.*.result, 'failure') }}
        uses: appleboy/telegram-action@master
        with:
          message: |
            ${{ github.actor }} –æ–±–Ω–æ–≤–∏–ª –ø—É–ª–ª —Ä–µ–∫–≤–µ—Å—Ç–∏–∫: ${{ github.event.pull_request.title }}
            
            –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç: ${{ github.event.commits[0].message }}
            
            –¢–µ—Å—Ç–∏–∫–∏: ‚úÖ
            
            –°—Å—ã–ª–æ—á–∫–∞: https://github.com/${{ github.repository }}/pull/${{ github.event.number }}
      - name: send message
        if: ${{ contains(needs.*.result, 'failure') }}
        uses: appleboy/telegram-action@master
        with:
          message: |
            ${{ github.actor }} –æ–±–Ω–æ–≤–∏–ª –ø—É–ª–ª —Ä–µ–∫–≤–µ—Å—Ç–∏–∫: ${{ github.event.pull_request.title }}

            –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç: ${{ github.event.commits[0].message }}

            –¢–µ—Å—Ç–∏–∫–∏: ‚ùå

            –°—Å—ã–ª–æ—á–∫–∞: https://github.com/${{ github.repository }}/pull/${{ github.event.number }}
  message:
    runs-on: ubuntu-latest
    if: ${{ always() && (github.event.action == 'opened' || github.event.pull_request.merged) && github.actor != 'renovate[bot]' && github.event.pull_request.user.login != 'renovate[bot]' }}
    needs: build
    steps:
      - if: ${{ github.event.pull_request.merged }}
        name: send merged
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.GROUP_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          format: markdown
          message: |
            üéâüéâüéâ–ü—Ä–æ–∏–∑–æ—à–ª–æ —Å–ª–∏—è–Ω–∏–µ: ${{ github.event.pull_request.title }}
            ```
            ‚†Ä‚£û‚¢Ω‚¢™‚¢£‚¢£‚¢£‚¢´‚°∫‚°µ‚£ù‚°Æ‚£ó‚¢∑‚¢Ω‚¢Ω‚¢Ω‚£Æ‚°∑‚°Ω‚£ú‚£ú‚¢Æ‚¢∫‚£ú‚¢∑‚¢Ω‚¢ù‚°Ω‚£ù
            ‚†∏‚°∏‚†ú‚†ï‚†ï‚†Å‚¢Å‚¢á‚¢è‚¢Ω‚¢∫‚£™‚°≥‚°ù‚£é‚£è‚¢Ø‚¢û‚°ø‚£ü‚£∑‚£≥‚¢Ø‚°∑‚£Ω‚¢Ω‚¢Ø‚£≥‚£´‚†á
            ‚†Ä‚†Ä‚¢Ä‚¢Ä‚¢Ñ‚¢¨‚¢™‚°™‚°é‚£Ü‚°à‚†ö‚†ú‚†ï‚†á‚†ó‚†ù‚¢ï‚¢Ø‚¢´‚£û‚£Ø‚£ø‚£ª‚°Ω‚£è‚¢ó‚£ó‚†è‚†Ä
            ‚†Ä‚†™‚°™‚°™‚£™‚¢™‚¢∫‚¢∏‚¢¢‚¢ì‚¢Ü‚¢§‚¢Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚¢ä‚¢û‚°æ‚£ø‚°Ø‚£è‚¢Æ‚†∑‚†Å‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚†à‚†ä‚†Ü‚°É‚†ï‚¢ï‚¢á‚¢á‚¢á‚¢á‚¢á‚¢è‚¢é‚¢é‚¢Ü‚¢Ñ‚†Ä‚¢ë‚£Ω‚£ø‚¢ù‚†≤‚†â‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°ø‚†Ç‚††‚†Ä‚°á‚¢á‚†ï‚¢à‚£Ä‚†Ä‚†Å‚†°‚†£‚°£‚°´‚£Ç‚£ø‚†Ø‚¢™‚†∞‚†Ç‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚†Ä‚°¶‚°ô‚°Ç‚¢Ä‚¢§‚¢£‚†£‚°à‚£æ‚°É‚††‚†Ñ‚†Ä‚°Ñ‚¢±‚£å‚£∂‚¢è‚¢ä‚†Ç‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚†Ä‚¢ù‚°≤‚£ú‚°Æ‚°è‚¢é‚¢å‚¢Ç‚†ô‚†¢‚†ê‚¢Ä‚¢ò‚¢µ‚£Ω‚£ø‚°ø‚†Å‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚†Ä‚†®‚£∫‚°∫‚°ï‚°ï‚°±‚°ë‚°Ü‚°ï‚°Ö‚°ï‚°ú‚°º‚¢Ω‚°ª‚†è‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚†Ä‚£º‚£≥‚£´‚£æ‚£µ‚£ó‚°µ‚°±‚°°‚¢£‚¢ë‚¢ï‚¢ú‚¢ï‚°ù‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚£¥‚£ø‚£æ‚£ø‚£ø‚£ø‚°ø‚°Ω‚°ë‚¢å‚†™‚°¢‚°£‚££‚°ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚°ü‚°æ‚£ø‚¢ø‚¢ø‚¢µ‚£Ω‚£æ‚£º‚£ò‚¢∏‚¢∏‚£û‚°ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
            ‚†Ä‚†Ä‚†Ä‚†Ä‚†Å‚†á‚†°‚†©‚°´‚¢ø‚£ù‚°ª‚°Æ‚£í‚¢Ω‚†ã‚†Ä‚†Ä
            ```
          photo: ./content/meme.jpg
      - if: ${{ !contains(needs.*.result, 'failure') && !github.event.pull_request.merged }}
        name: send if correct
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.GROUP_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message: |
            ${{ github.actor }} —Å–æ–∑–¥–∞–ª –ø—É–ª–ª —Ä–µ–∫–≤–µ—Å—Ç–∏–∫:
            ${{ github.event.pull_request.title }}

            –¢–µ—Å—Ç–∏–∫–∏: ‚úÖ

            –°—Å—ã–ª–æ—á–∫–∞: https://github.com/${{ github.repository }}/pull/${{ github.event.number }}
      - if: ${{ contains(needs.*.result, 'failure') && !github.event.pull_request.merged }}
        name: send if incorrect
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.GROUP_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message: |
            ${{ github.actor }} —Å–æ–∑–¥–∞–ª –ø—É–ª–ª —Ä–µ–∫–≤–µ—Å—Ç–∏–∫:
            ${{ github.event.pull_request.title }}

            –¢–µ—Å—Ç–∏–∫–∏: ‚ùå

            –°—Å—ã–ª–æ—á–∫–∞: https://github.com/${{ github.repository }}/pull/${{ github.event.number }}

        
